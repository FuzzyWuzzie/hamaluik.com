<!DOCTYPE html> <html lang="en-CA"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Dynamic Blender Properties</title> <link rel="alternate" type="application/rss+xml" href="https://blog.hamaluik.ca/feed.rss" title="Posts RSS"> <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"> <link rel="manifest" href="/site.webmanifest"> <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ff5555"> <meta name="msapplication-TileColor" content="#ff5555"> <meta name="theme-color" content="#ff5555"> <meta property="og:title" content="Dynamic Blender Properties"/> <meta property="og:url" content="http://blog.hamaluik.ca/posts/dynamic-blender-properties/"/> <meta property="og:image" content="https://og-image.now.sh/Dynamic%20Blender%20Properties.png?theme=light&md=0&fontSize=75px&images=https%3A%2F%2Fassets.zeit.co%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fhyper-color-logo.svg&widths=350&heights=350"/> <meta property="og:description" content="As part of my most recent adventures in game engine programming, I came across a small problem—I needed a way to edit levels (both their geometry, and the entities within the level and their associated components). Writing an editor to do this is a rather daunting task. Thankfully, Blender is a free, open-source 3D application that is &#x27;easily&#x27; extended (well, easy-ish). So, instead of writing my own editor, I can write a Blender addon to make it do what I need it to. First up in that, was presenting an interface for editing which components an object has, and setting the values of each components&#x27; attributes. I found this to be more difficult that I expected, thanks to the way Blender handles and presents data. I will show you here how I got things working, as there doesn&#x27;t seem to be documentation on this and I had to wade through a lot of half-expired forum posts to get things working."/> <meta property="og:type" content="article"/> <meta property="og:locale" content="en_CA"/> <meta property="og:site_name" content="Kenton Hamaluik"/> <meta property="article:published_time" content=" 2016-09-17T19:58:22+00:00 "/> <meta property="article:author" content="http://blog.hamaluik.ca/"/> <meta property="article:tag" content="Blender"/> <meta property="article:tag" content="Python"/> <meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:image:alt" content="Dynamic Blender Properties"/> <style> @font-face {font-family:"Crimson Pro";font-style:italic;font-weight:400;font-display:swap;src:local("Crimson Pro Italic"),local("CrimsonPro Italic"),local("Crimson-Pro-Italic"),local("CrimsonPro-Italic"),url(/fonts/crimson-pro-normal-latin-ext.woff2) format("woff2"),url(/fonts/CrimsonPro-Italic.ttf) format("ttf");unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face {font-family:"Crimson Pro";font-style:italic;font-weight:400;font-display:swap;src:local("Crimson Pro Italic"),local("CrimsonPro Italic"),local("Crimson-Pro-Italic"),local("CrimsonPro-Italic"),url(/fonts/crimson-pro-italic-latin.woff2) format("woff2"),url(/fonts/CrimsonPro-Italic.ttf) format("ttf");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face {font-family:"Crimson Pro";font-style:normal;font-weight:400;font-display:swap;src:local("Crimson Pro"),local("CrimsonPro"),local("Crimson-Pro"),local("CrimsonPro"),url(/fonts/crimson-pro-normal-latin-ext.woff2) format("woff2"),url(/fonts/CrimsonPro-Regular.ttf.ttf) format("ttf");unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face {font-family:"Crimson Pro";font-style:normal;font-weight:400;font-display:swap;src:local("Crimson Pro"),local("CrimsonPro"),local("Crimson-Pro"),local("CrimsonPro"),url(/fonts/crimson-pro-normal-latin.woff2) format("woff2"),url(/fonts/CrimsonPro-Regular.ttf.ttf) format("ttf");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face {font-family:"Crimson Pro";font-style:normal;font-weight:700;font-display:swap;src:local("Crimson Pro Bold"),local("CrimsonPro Bold"),local("Crimson-Pro-Bold"),local("CrimsonPro-Bold"),url(/fonts/crimson-pro-bold-latin-ext.woff2) format("woff2"),url(/fonts/CrimsonPro-Bold.ttf.ttf) format("ttf");unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face {font-family:"Crimson Pro";font-style:normal;font-weight:700;font-display:swap;src:local("Crimson Pro Bold"),local("CrimsonPro Bold"),local("Crimson-Pro-Bold"),local("CrimsonPro-Bold"),url(/fonts/crimson-pro-bold-latin.woff2) format("woff2"),url(/fonts/CrimsonPro-Bold.ttf.ttf) format("ttf");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}:root{--background-colour:#fafafa;--font-colour:#222;--footer-colour:#222;--link-colour:#076678;--visited-colour:#8f3f71;--theme-background:#282a36;--theme-currentline:#44475a;--theme-selection:#44475a;--theme-foreground:#f8f8f2;--theme-comment:#6272a4;--theme-cyan:#8be9fd;--theme-green:#50fa7b;--theme-orange:#ffb86c;--theme-pink:#ff79c6;--theme-purple:#bd93f9;--theme-red:#ff5555;--theme-yellow:#f1fa8c;}*{box-sizing:border-box;margin:0;}body{display:flex;flex-direction:column;min-height:100vh;padding:1rem clamp(1rem,5vw,3rem) 1rem;font-family:"Crimson Pro",Constantia,"Lucida Bright",Lucidabright,"Lucida Serif",Lucida,"DejaVu Serif","Bitstream Vera Serif","Liberation Serif",Georgia,serif;font-size:16pt;line-height:1.5;color:var(--font-colour);background:var(--background-colour);}body>*{--layout-spacing:max(2vh,2rem);width:100%;max-width:70ch;margin-left:auto;margin-right:auto;}main{margin-top:var(--layout-spacing);}footer{margin-top:auto;padding-top:var(--layout-spacing);}footer p{border-top:1px solid var(--footer-colour);padding-top:0.25em;font-size:0.9rem;color:var(--footer-colour);display:flex;justify-content:space-between;}:is(h1,h2,h3){line-height:1.2;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue;}:is(h2,h3,figure):not(:first-child){margin-top:2em;}article*+*{margin-top:1em;}li>a{text-decoration:none;}a{word-break:break-all;color:var(--link-colour);text-underline-offset:0.15em;}a:visited{color:var(--visited-colour);}:not(pre)>code{word-break:break-all;font-family:"Source Code Pro","Fira Code","Fira Mono",Consolas,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L",Monaco,"Courier New",Courier,monospace;font-size:12pt;}pre,figure{overflow-x:auto;}figure{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:100%;}figure>a>img,figure>img,figure>video{max-width:100%;margin:0 auto;}figure figcaption{font-size:0.8rem;text-align:center;}time{font-size:0.8rem;}header h1 a{color:var(--font-colour);font-size:4rem;font-weight:bold;word-break:normal;}header h1 a:visited{color:var(--font-colour);}svg{color:var(--font-colour);fill:currentColor;}img.white{mix-blend-mode:multiply;}.highlight{font-family:"Source Code Pro","Fira Code","Fira Mono",Consolas,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L",Monaco,"Courier New",Courier,monospace;font-size:12pt;padding:0.25em;margin:1em 0;}.highlight .hll{background-color:#ffffcc;}.highlight{background:#282828;color:#ebdbb2;background-color:#282828;}.highlight .c{color:#928374;font-style:italic;background-color:#282828;}.highlight .err{color:#ebdbb2;background-color:#282828;}.highlight .esc{color:#ebdbb2;background-color:#282828;}.highlight .g{color:#ebdbb2;background-color:#282828;}.highlight .k{color:#fe8019;background-color:#282828;}.highlight .l{color:#ebdbb2;background-color:#282828;}.highlight .n{color:#ebdbb2;background-color:#282828;}.highlight .o{color:#fe8019;background-color:#282828;}.highlight .x{color:#ebdbb2;background-color:#282828;}.highlight .p{color:#ebdbb2;background-color:#282828;}.highlight .ch{color:#928374;font-style:italic;background-color:#282828;}.highlight .cm{color:#928374;font-style:italic;background-color:#282828;}.highlight .cp{color:#8ec07c;background-color:#282828;}.highlight .c1{color:#928374;font-style:italic;background-color:#282828;}.highlight .cs{color:#928374;font-style:italic;background-color:#282828;}.highlight .gd{color:#282828;background-color:#fb4934;}.highlight .ge{color:#83a598;text-decoration:underline;background-color:#282828;}.highlight .gr{color:#ebdbb2;font-weight:bold;background-color:#fb4934;}.highlight .gh{color:#b8bb26;font-weight:bold;background-color:#282828;}.highlight .gi{color:#282828;background-color:#b8bb26;}.highlight .go{color:#504945;background-color:#282828;}.highlight .gp{color:#ebdbb2;background-color:#282828;}.highlight .gs{color:#ebdbb2;background-color:#282828;}.highlight .gu{color:#b8bb26;font-weight:bold;background-color:#282828;}.highlight .gt{color:#ebdbb2;font-weight:bold;background-color:#fb4934;}.highlight .kc{color:#fe8019;background-color:#282828;}.highlight .kd{color:#fe8019;background-color:#282828;}.highlight .kn{color:#fe8019;background-color:#282828;}.highlight .kp{color:#fe8019;background-color:#282828;}.highlight .kr{color:#fe8019;background-color:#282828;}.highlight .kt{color:#fabd2f;background-color:#282828;}.highlight .ld{color:#ebdbb2;background-color:#282828;}.highlight .m{color:#d3869b;background-color:#282828;}.highlight .s{color:#b8bb26;background-color:#282828;}.highlight .na{color:#b8bb26;font-weight:bold;background-color:#282828;}.highlight .nb{color:#fabd2f;background-color:#282828;}.highlight .nc{color:#ebdbb2;background-color:#282828;}.highlight .no{color:#d3869b;background-color:#282828;}.highlight .nd{color:#ebdbb2;background-color:#282828;}.highlight .ni{color:#fabd2f;background-color:#282828;}.highlight .ne{color:#fb4934;background-color:#282828;}.highlight .nf{color:#fabd2f;background-color:#282828;}.highlight .nl{color:#fb4934;background-color:#282828;}.highlight .nn{color:#ebdbb2;background-color:#282828;}.highlight .nx{color:#ebdbb2;background-color:#282828;}.highlight .py{color:#ebdbb2;background-color:#282828;}.highlight .nt{color:#fb4934;background-color:#282828;}.highlight .nv{color:#ebdbb2;background-color:#282828;}.highlight .ow{color:#fe8019;background-color:#282828;}.highlight .w{color:#ebdbb2;background-color:#282828;}.highlight .mb{color:#d3869b;background-color:#282828;}.highlight .mf{color:#d3869b;background-color:#282828;}.highlight .mh{color:#d3869b;background-color:#282828;}.highlight .mi{color:#d3869b;background-color:#282828;}.highlight .mo{color:#d3869b;background-color:#282828;}.highlight .sb{color:#b8bb26;background-color:#282828;}.highlight .sc{color:#b8bb26;background-color:#282828;}.highlight .sd{color:#b8bb26;background-color:#282828;}.highlight .s2{color:#b8bb26;background-color:#282828;}.highlight .se{color:#b8bb26;background-color:#282828;}.highlight .sh{color:#b8bb26;background-color:#282828;}.highlight .si{color:#b8bb26;background-color:#282828;}.highlight .sx{color:#b8bb26;background-color:#282828;}.highlight .sr{color:#b8bb26;background-color:#282828;}.highlight .s1{color:#b8bb26;background-color:#282828;}.highlight .ss{color:#83a598;background-color:#282828;}.highlight .bp{color:#fabd2f;background-color:#282828;}.highlight .vc{color:#ebdbb2;background-color:#282828;}.highlight .vg{color:#ebdbb2;background-color:#282828;}.highlight .vi{color:#ebdbb2;background-color:#282828;}.highlight .il{color:#d3869b;background-color:#282828;}.slideshow{width:100%;}.slideshow .slides{display:grid;grid-auto-flow:column;grid-gap:1.5rem;overflow-x:auto;scroll-snap-type:x mandatory;padding:0 0 1.5rem;-webkit-overflow-scrolling:touch;}.slideshow .slides>*{width:min(45ch,60vw);height:auto;scroll-snap-align:center;scroll-snap-stop:always;}</style> </head> <body> <header> <h1><a href="https://blog.hamaluik.ca/">Kenton Hamaluik</a></h1> </header> <main> <article> <header> <h1> Dynamic Blender Properties <time datetime='2016-09-17T19:58:22+00:00'>(2016-09-17)</time> </h1> </header> <p>As part of my most recent adventures in game engine programming, I came across a small problem—I needed a way to edit levels (both their geometry, and the entities within the level and their associated components). Writing an editor to do this is a rather daunting task. Thankfully, <a href="https://www.blender.org/">Blender</a> is a free, open-source 3D application that is “easily” extended (well, easy-<em>ish</em>). So, instead of writing my own editor, I can write a Blender addon to make it do what I need it to. First up in that, was presenting an interface for editing which components an object has, and setting the values of each components’ attributes. I found this to be more difficult that I expected, thanks to the way Blender handles and presents data. I will show you here how I got things working, as there doesn’t seem to be documentation on this and I had to wade through a lot of half-expired forum posts to get things working.</p> <p>Basically, in order to display any data in a panel in Blender, you must pre-define the property classes that it will render. The following code listing shows a simple panel which will show up in the object section of the properties panel:</p> <figure> <img src="/images/dynamic-blender-properties/sample-predefined-property.png"> <figcaption>A sample panel displaying the pre-defined properties in the pre-defined `SamplePropertyGroup` class.</figcaption> </figure> <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bpy</span>
<span class="kn">from</span> <span class="nn">bpy.props</span> <span class="kn">import</span> <span class="n">FloatProperty</span><span class="p">,</span> <span class="n">PointerProperty</span>
<span class="kn">from</span> <span class="nn">bpy.types</span> <span class="kn">import</span> <span class="n">PropertyGroup</span>

<span class="k">class</span> <span class="nc">SamplePropertyGroup</span><span class="p">(</span><span class="n">PropertyGroup</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">42.0</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SamplePanel</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="n">bl_label</span> <span class="o">=</span> <span class="s2">&quot;Sample Panel&quot;</span>
    <span class="n">bl_space_type</span> <span class="o">=</span> <span class="s1">&#39;PROPERTIES&#39;</span>
    <span class="n">bl_region_type</span> <span class="o">=</span> <span class="s1">&#39;WINDOW&#39;</span>
    <span class="n">bl_context</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">object</span>

        <span class="n">sampleProperty</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">samplePropertyGroup</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">sampleProperty</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">sampleProperty</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="n">SamplePropertyGroup</span><span class="p">)</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="n">SamplePanel</span><span class="p">)</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">samplePropertyGroup</span> <span class="o">=</span> <span class="n">PointerProperty</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">SamplePropertyGroup</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">unregister</span><span class="p">():</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unregister_class</span><span class="p">(</span><span class="n">SamplePropertyGroup</span><span class="p">)</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unregister_class</span><span class="p">(</span><span class="n">SamplePanel</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">samplePropertyGroup</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">register</span><span class="p">()</span>
</pre></div> <p>A problem arises, however, when you don’t know ahead of time what that <code>SamplePropertyGroup</code> class will look like. Or even if it will exist (or what custom property groups <em>will</em> exist). For my use case, I want to have each component exist in blender as it’s own subclass of the <code>PropertyGroup</code> class, with its list of attributes defined as class members (as relevant <code>PropertyTypes</code>). Forunately for us, Python is a scripted language, and comes with some tools to dynamically create classes and interact with them via the <a href="https://docs.python.org/2/library/functions.html#type"><code>type()</code></a>, <a href="https://docs.python.org/2/library/functions.html#setattr"><code>setattr()</code></a>, <a href="https://docs.python.org/2/library/functions.html#getattr"><code>getattr()</code></a>, and <a href="https://docs.python.org/2/library/functions.html#delattr"><code>delattr()</code></a> built-in functions.</p> <p>Simply put, we can use <code>type()</code> to go from this:</p> <div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SamplePropertyGroup</span><span class="p">(</span><span class="n">PropertyGroup</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">42.0</span><span class="p">)</span>
</pre></div> <p>to this:</p> <div class="highlight"><pre><span></span><span class="n">SamplePropertyGroup</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span>
    <span class="s2">&quot;SamplePropertyGroup&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="n">PropertyGroup</span><span class="p">,),</span>
    <span class="p">{</span>
        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">42.0</span><span class="p">)</span>
    <span class="p">})</span>
</pre></div> <p>We can easily script this to be more dynamic, such that given a dictionary (which we can parse from a JSON file at runtime) that looks like this:</p> <div class="highlight"><pre><span></span><span class="n">propertyGroupLayouts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Health&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;current&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;Character&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div> <p>We can dynamically create our property groups and register them with Blender by simply iterating the dictionary and constructing classes as we go:</p> <div class="highlight"><pre><span></span><span class="c1"># iterate over our list of property groups</span>
<span class="k">for</span> <span class="n">groupName</span><span class="p">,</span> <span class="n">attributeDefinitions</span> <span class="ow">in</span> <span class="n">propertyGroupLayouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># build the attribute dictionary for this group</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">attributeDefinition</span> <span class="ow">in</span> <span class="n">attributeDefinitions</span><span class="p">:</span>
        <span class="n">attType</span> <span class="o">=</span> <span class="n">attributeDefinition</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="n">attName</span> <span class="o">=</span> <span class="n">attributeDefinition</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">attType</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">attName</span><span class="p">]</span> <span class="o">=</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">attName</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">attType</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">:</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">attName</span><span class="p">]</span> <span class="o">=</span> <span class="n">StringProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">attName</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unsupported type (</span><span class="si">%s</span><span class="s1">) for </span><span class="si">%s</span><span class="s1"> on </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attType</span><span class="p">,</span> <span class="n">attName</span><span class="p">,</span> <span class="n">groupName</span><span class="p">))</span>

    <span class="c1"># now build the property group class</span>
    <span class="n">propertyGroupClass</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">groupName</span><span class="p">,</span> <span class="p">(</span><span class="n">PropertyGroup</span><span class="p">,),</span> <span class="n">attributes</span><span class="p">)</span>

    <span class="c1"># register it with Blender</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="n">propertyGroupClass</span><span class="p">)</span>

    <span class="c1"># apply it to all Objects</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">groupName</span><span class="p">,</span> <span class="n">PointerProperty</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">propertyGroupClass</span><span class="p">))</span>
</pre></div> <p>Now, whenever we register we just call the above code, and our <code>PropertyGroup</code> classes will be defined and registered in Blender as properties of all objects! Don’t forget to clean up the registered objects in <code>unregister()</code>!</p> <p>Finally, to actually show our properties in a Blender panel is relatively straightforward:</p> <div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SamplePanel</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="n">bl_label</span> <span class="o">=</span> <span class="s2">&quot;Sample Panel&quot;</span>
    <span class="n">bl_space_type</span> <span class="o">=</span> <span class="s1">&#39;PROPERTIES&#39;</span>
    <span class="n">bl_region_type</span> <span class="o">=</span> <span class="s1">&#39;WINDOW&#39;</span>
    <span class="n">bl_context</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">object</span>

        <span class="c1"># use our layout definition to dynamically create our panel items</span>
        <span class="k">for</span> <span class="n">groupName</span><span class="p">,</span> <span class="n">attributeDefinitions</span> <span class="ow">in</span> <span class="n">propertyGroupLayouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># get the instance of our group</span>
            <span class="c1"># dynamic equivalent of `obj.samplePropertyGroup` from before</span>
            <span class="n">propertyGroup</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">groupName</span><span class="p">)</span>

            <span class="c1"># start laying this group out</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
            <span class="n">col</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">groupName</span><span class="p">)</span>

            <span class="c1"># loop through all the attributes and show them</span>
            <span class="k">for</span> <span class="n">attributeDefinition</span> <span class="ow">in</span> <span class="n">attributeDefinitions</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">propertyGroup</span><span class="p">,</span> <span class="n">attributeDefinition</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="c1"># draw a separation between groups</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">separator</span><span class="p">()</span>
</pre></div> <p>And there you have it, dynamic properties (created at run-time, not write-time) in Blender!</p> <figure> <img src="/images/dynamic-blender-properties/sample-finished-result.png"> <figcaption>What the finished result will look like.</figcaption> </figure> <p>Here is the full source code for the above example:</p> <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bpy</span>
<span class="kn">from</span> <span class="nn">bpy.props</span> <span class="kn">import</span> <span class="n">FloatProperty</span><span class="p">,</span> <span class="n">StringProperty</span><span class="p">,</span> <span class="n">PointerProperty</span>
<span class="kn">from</span> <span class="nn">bpy.types</span> <span class="kn">import</span> <span class="n">PropertyGroup</span>

<span class="c1"># TODO: load dynamically at runtime from a JSON file!</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">propertyGroupLayouts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Health&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;current&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;Character&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">samplePropertyGroups</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">class</span> <span class="nc">SamplePanel</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="n">bl_label</span> <span class="o">=</span> <span class="s2">&quot;Sample Panel&quot;</span>
    <span class="n">bl_space_type</span> <span class="o">=</span> <span class="s1">&#39;PROPERTIES&#39;</span>
    <span class="n">bl_region_type</span> <span class="o">=</span> <span class="s1">&#39;WINDOW&#39;</span>
    <span class="n">bl_context</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">object</span>

        <span class="c1"># use our layout definition to dynamically create our panel items</span>
        <span class="k">for</span> <span class="n">groupName</span><span class="p">,</span> <span class="n">attributeDefinitions</span> <span class="ow">in</span> <span class="n">bpy</span><span class="o">.</span><span class="n">propertyGroupLayouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># get the instance of our group</span>
            <span class="c1"># dynamic equivalent of `obj.samplePropertyGroup` from before</span>
            <span class="n">propertyGroup</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">groupName</span><span class="p">)</span>

            <span class="c1"># start laying this group out</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
            <span class="n">col</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">groupName</span><span class="p">)</span>

            <span class="c1"># loop through all the attributes and show them</span>
            <span class="k">for</span> <span class="n">attributeDefinition</span> <span class="ow">in</span> <span class="n">attributeDefinitions</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">prop</span><span class="p">(</span><span class="n">propertyGroup</span><span class="p">,</span> <span class="n">attributeDefinition</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="c1"># draw a separation between groups</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">separator</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
    <span class="c1"># register the panel class</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="n">SamplePanel</span><span class="p">)</span>

    <span class="c1"># iterate over our list of property groups</span>
    <span class="k">for</span> <span class="n">groupName</span><span class="p">,</span> <span class="n">attributeDefinitions</span> <span class="ow">in</span> <span class="n">bpy</span><span class="o">.</span><span class="n">propertyGroupLayouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># build the attribute dictionary for this group</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attributeDefinition</span> <span class="ow">in</span> <span class="n">attributeDefinitions</span><span class="p">:</span>
            <span class="n">attType</span> <span class="o">=</span> <span class="n">attributeDefinition</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
            <span class="n">attName</span> <span class="o">=</span> <span class="n">attributeDefinition</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">attType</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
                <span class="n">attributes</span><span class="p">[</span><span class="n">attName</span><span class="p">]</span> <span class="o">=</span> <span class="n">FloatProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">attName</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">attType</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">:</span>
                <span class="n">attributes</span><span class="p">[</span><span class="n">attName</span><span class="p">]</span> <span class="o">=</span> <span class="n">StringProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">attName</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unsupported type (</span><span class="si">%s</span><span class="s1">) for </span><span class="si">%s</span><span class="s1"> on </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attType</span><span class="p">,</span> <span class="n">attName</span><span class="p">,</span> <span class="n">groupName</span><span class="p">))</span>

        <span class="c1"># now build the property group class</span>
        <span class="n">propertyGroupClass</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">groupName</span><span class="p">,</span> <span class="p">(</span><span class="n">PropertyGroup</span><span class="p">,),</span> <span class="n">attributes</span><span class="p">)</span>

        <span class="c1"># register it with Blender</span>
        <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="n">propertyGroupClass</span><span class="p">)</span>

        <span class="c1"># apply it to all Objects</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">groupName</span><span class="p">,</span> <span class="n">PointerProperty</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">propertyGroupClass</span><span class="p">))</span>

        <span class="c1"># store it for later</span>
        <span class="n">bpy</span><span class="o">.</span><span class="n">samplePropertyGroups</span><span class="p">[</span><span class="n">groupName</span><span class="p">]</span> <span class="o">=</span> <span class="n">propertyGroupClass</span>

<span class="k">def</span> <span class="nf">unregister</span><span class="p">():</span>
    <span class="c1"># unregister the panel class</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unregister_class</span><span class="p">(</span><span class="n">SamplePanel</span><span class="p">)</span>

    <span class="c1"># unregister our components</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">bpy</span><span class="o">.</span><span class="n">samplePropertyGroups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unregister_class</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">samplePropertyGroups</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">register</span><span class="p">()</span>
</pre></div> <p>There are of course many more things that need to be done to make this a fully working system, but hopefully this can help you get started. I will continue working on my engine tools addon and release it when it’s ready (you can follow progress at <a href="https://github.com/BlazingMammothGames/mammoth_blender_tools">BlazingMammothGames/mammoth_blender_tools</a> if you really like). The tool, when done, will hopefully server as a solid example for adapting Blender to your own needs in the future. For now, if you run into any trouble, don’t hesitate to ask for help in the comments!</p> <script src="/ruffle/ruffle.js"></script> </article> </main> <footer> <p> <span>© 2022 <a href="https://hamaluik.ca">Kenton Hamaluik</a></span> <span><a class="has-icon" href="https://blog.hamaluik.ca/feed.rss"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><path d="M48,144a64,64,0,0,1,64,64" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path><path d="M48,96A112,112,0,0,1,160,208" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path><path d="M48,48A160,160,0,0,1,208,208" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path><circle cx="52" cy="204" r="12"></circle></svg> Subscribe</a></span> </p> </footer> </body> </html>